function initMap(){var e=new google.maps.LatLng(47.6062,(-122.3321));map=new google.maps.Map(document.getElementById("map"),{center:e,zoom:13,streetViewControl:!1,mapTypeControl:!1}),infowindow=new google.maps.InfoWindow,bounds=new google.maps.LatLngBounds,ko.applyBindings(new viewModel)}function locationData(e,t){this.name=ko.observable(e.name),this.lat=ko.observable(e.lat),this.lng=ko.observable(e.lng),this.placeId=ko.observable(e.placeId),this.marker=t}function viewModel(){function e(e,a){for(var n=0;n<e.length;n++){var o=e[n],i=new google.maps.LatLng(o.lat,o.lng),s=new google.maps.Marker({map:map,title:o.name,position:i,id:o.venueId,animation:google.maps.Animation.DROP});s.addListener("click",function(){markerInfoWindow(this,infowindow)}),placeMarkers.push(s),t.locations.push(new locationData(o,s)),bounds.extend(i)}map.fitBounds(bounds),map.setOptions({styles:a})}var t=this;this.locations=ko.observableArray([]),this.animate=ko.observable(""),this.showList=ko.observable(!0),this.darkenDayBtn=ko.observable(!0),this.toggleList=function(){t.showList()?t.showList(!1):t.showList(!0),t.showList()?t.animate("hide-list"):t.animate("show-list")},this.dayVsNight=function(a){if(t.locations.removeAll(),removeMarkers(),"night"===a){e(nightLocations,nightStyle),t.darkenDayBtn(!1);var n=new google.maps.LatLng(nightLocations[0].lat,nightLocations[0].lng);map.panTo(n)}else e(dayLocations),t.darkenDayBtn(!0)},e(dayLocations),this.filter=ko.observable(""),this.filteredLocations=ko.computed(function(){return ko.utils.arrayFilter(t.locations(),function(e){var a=e.name().toLowerCase(),n=t.filter().toLowerCase(),o=a.indexOf(n);return o>=0?(e.marker.setVisible(!0),e.name()):void e.marker.setVisible(!1)})}),this.currentLocation=ko.observable(this.locations()[0]),this.setLocation=function(e){t.currentLocation(e);var a=t.currentLocation().marker,n=a.getPosition();map.setCenter(n),markerInfoWindow(t.currentLocation().marker,infowindow),$(window).width()<=450&&t.toggleList()}}function removeMarkers(){for(var e=0;e<placeMarkers.length;e++)placeMarkers[e].setMap(null);placeMarkers=[]}function markerInfoWindow(e,t){for(var a=0;a<placeMarkers.length;a++)placeMarkers[a].setAnimation(null);t.addListener("closeclick",function(){e.setAnimation(null)}),e===t.anchor?t.close():locationDetails(e,t)}function locationDetails(e,t){var a=e.id,n="5QH5BQKIHD5AYO0YDHZZOA0JI10K5F5OAORSBWZXJX5KPAIG",o="IDJ0GEAFC25OXFVFHB12HNFHKAHNGDZPMGTLTTOBL3PN3AWI";e.setAnimation(google.maps.Animation.BOUNCE),t.open(map,e),$.when($.ajax({async:!0,cache:!0,url:"https://api.foursquare.com/v2/venues/"+a+"?client_id="+n+"&client_secret="+o+"&v=20160720",error:function(){alert("Sorry, unable to obtain location details. Please refresh the page and try again.")}})).done(function(a){var n=a.response.venue.photos.groups[0].items[0].prefix+"250x160"+a.response.venue.photos.groups[0].items[1].suffix,o=e.title,i=a.response.venue.location.formattedAddress,s=a.response.venue.contact.formattedPhone,r=a.response.venue.hours,l=a.response.venue.rating,f=a.response.venue.hereNow.summary,c='<div">';n&&(c+='<img src="'+n+'">',c+="<br><strong>"+o+"</strong>"),i&&(c+="<br>"+i[0]+"<br>"+i[1]),s&&(c+="<br>"+s),r&&(c+="<br>"+r.status),l&&(c+="<br><br>Rating: "+l),f&&(c+="<br>"+f),c+='<br><br><i>Data Source: <a href="https://foursquare.com/">Foursquare</a></i></div>',t.setContent(c)})}function googleError(){alert("Sorry, Google Maps could not be loaded. Please refresh the page and try again.")}var map,bounds,infowindow,placeMarkers=[],dayLocations=[{name:"Space Needle",lat:47.6205063,lng:-122.3492774,venueId:"416dc180f964a5209b1d1fe3"},{name:"Green Leaf Vietnamese Restaurant",lat:47.61670840000001,lng:-122.3517688,venueId:"4fb18f18e4b010d66e81ba9f"},{name:"Washington Park Aboretum",lat:47.64013920000001,lng:-122.2937804,venueId:"456f3980f964a520293e1fe3"},{name:"La Parisienne",lat:47.6167233,lng:-122.3466166,venueId:"52e410a2498e9aa390a5a57e"},{name:"Pike Place Market",lat:47.6107056,lng:-122.34262260000003,venueId:"427ea800f964a520b1211fe3"},{name:"The Center for Wooden Boats",lat:47.6264836,lng:-122.3357686,venueId:"4700c686f964a520354b1fe3"},{name:"Gas Works Park",lat:47.6456308,lng:-122.33435320000001,venueId:"430bb880f964a5203a271fe3"},{name:"Brandon Lee and Bruce Lee's Grave Site",lat:47.6337698,lng:-122.3158282,venueId:"4b91714cf964a520d9bc33e3"}],nightLocations=[{name:"Umi Sake House",lat:47.6132995,lng:-122.34610700000002,venueId:"447da2d6f964a520fb331fe3"},{name:"Seattle Great Wheel",lat:47.60608000000001,lng:-122.34250400000002,venueId:"4fbfa89ee4b0fddeca5b5cef"},{name:"The Pink Door",lat:47.61028899999999,lng:-122.3426586,venueId:"40b13b00f964a52066f71ee3"},{name:"Foundation Nightclub",lat:47.6124774,lng:-122.34641870000002,venueId:"50188ad9e4b097c9194701f1"},{name:"Rock Box",lat:47.61551009999999,lng:-122.32018970000001,venueId:"4ce7469f9f776ea8aa225722"},{name:"Raygun Lounge",lat:47.6150589,lng:-122.32516729999998,venueId:"5025abd0e4b0f6756695d4c1"},{name:"Chihuly Garden and Glass",lat:47.620563,lng:-122.35046599999998,venueId:"4f2334b8e4b0085e48b153c0"}],nightStyle=[{elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{visibility:"on"},{weight:.1},{lightness:-14},{color:"#5f6666"}]},{featureType:"landscape",elementType:"labels.text.fill",stylers:[{visibility:"on"},{color:"#525351"}]},{featureType:"landscape.man_made",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#04142b"},{lightness:-37}]},{featureType:"landscape.natural",elementType:"geometry.fill",stylers:[{visibility:"on"},{lightness:-49},{color:"#081620"}]},{featureType:"poi",elementType:"labels.text.stroke",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{visibility:"on"},{color:"#585959"}]},{featureType:"poi",elementType:"geometry",stylers:[{visibility:"on"},{lightness:-21},{color:"#081424"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#AB2C2A"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{visibility:"on"},{color:"#273235"},{weight:1.5}]},{featureType:"road.local",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{color:"#5c6060"}]},{featureType:"water",elementType:"geometry",stylers:[{visibility:"on"},{color:"#0c101b"},{lightness:-54}]}];